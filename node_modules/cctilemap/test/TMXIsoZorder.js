var TMXIsoZorder = cc.Layer.extend({
    tamara:null,
    init : function(){
        this._super();

        var map = cc.TMXTiledMap.create(res.iso_test_zorder_tmx);
        this.addChild(map, 0, 1);

        var s = map.getContentSize();
        map.setPosition(-s.width / 2, 0);

        this.tamara = cc.Sprite.create(res.grossinis_sister1_png);
        map.addChild(this.tamara, map.getChildren().length);
        var mapWidth = map.getMapSize().width * map.getTileSize().width;
        this.tamara.setPosition(mapWidth / 2 + 180, 130);
        this.tamara.setAnchorPoint(0.5, 0);

        this.schedule(this.repositionSprite);

        return true;
    },
    repositionSprite:function (dt) {
        var p = this.tamara.getPosition();
        var map = this.getChildByTag(1);

        var newZ = 4 - (p.y / 48);
        newZ = parseInt(Math.max(newZ, 0), 10);
        map.reorderChild(this.tamara, newZ);
    }
});

TMXIsoZorder.create = function(args){
    var layer = new TMXIsoZorder();
    return layer.init() ? layer : null;
};