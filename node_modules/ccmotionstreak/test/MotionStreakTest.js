/**
 * Created by Huabin LING on 12/31/13.
 */

var MotionStreakTest = cc.Layer.extend({
    _colorStreak:null,
    _spriteStreak:null,
    _center:null,
    _radius:0,
    _angle:0,

    onEnter:function () {
        this._super();

        var winSize = cc.Director.getInstance().getWinSize();

        // Create the streak object and add it to the scene
        this._colorStreak = cc.MotionStreak.create(2, 3, 32, cc.GREEN, res.streak_png);
        this.addChild(this._colorStreak);

        // Sprite based motion streak
        this._spriteStreak = cc.MotionStreak.create(2.0, 1.0, 50.0, cc.c3b(255, 255, 0), res.Icon_png);
        this.addChild(this._spriteStreak);

        this._center = cc.p(winSize.width / 2, winSize.height / 2);
        this._radius = winSize.width / 4;
        this._angle = 0.0;

        // schedule an update on each frame so we can syncronize the streak
        this.schedule(this.onUpdate);
    },

    onUpdate:function (delta) {
        this._angle += 1.0;

        this._colorStreak.setPosition(this._center.x + Math.cos(this._angle / 180 * Math.PI) * this._radius/2,
            this._center.y + Math.sin(this._angle / 180 * Math.PI) * this._radius/2);

        this._spriteStreak.setPosition(this._center.x + Math.cos(this._angle / 180 * Math.PI) * this._radius,
            this._center.y + Math.sin(this._angle / 180 * Math.PI) * this._radius);
    }
});

MotionStreakTest.create = function() {
    var layer = new MotionStreakTest();
    return layer;
};