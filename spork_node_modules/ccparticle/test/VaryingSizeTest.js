/**
 * Created by Huabin LING on 12/31/13.
 */

var VaryingSizeTest = ParticleTest.extend({
    onEnter:function () {
        this._super();

        // Create particle emitter
        this._emitter = cc.ParticleSystem.createWithTotalParticles(200);
        // Set particle texture
        this._background.addChild(this._emitter, 10);

        var winSize = cc.Director.getInstance().getWinSize();

        // duration
        this._emitter.setDuration(-1);

        // gravity
        this._emitter.setGravity(cc.p(0, 0));

        // angle
        this._emitter.setAngle(0);
        this._emitter.setAngleVar(360);

        // radial
        this._emitter.setRadialAccel(70);
        this._emitter.setRadialAccelVar(10);

        // tagential
        this._emitter.setTangentialAccel(80);
        this._emitter.setTangentialAccelVar(0);

        // speed of particles
        this._emitter.setSpeed(50);
        this._emitter.setSpeedVar(10);

        // life of particles
        this._emitter.setLife(2.0);
        this._emitter.setLifeVar(0.3);

        // emits per frame
        this._emitter.setEmissionRate(this._emitter.getTotalParticles() / this._emitter.getLife());

        // color of particles
        var startColor = cc.c4f(0.5, 0.5, 0.5, 1.0);
        this._emitter.setStartColor(startColor);

        var startColorVar = cc.c4f(0.5, 0.5, 0.5, 1.0);
        this._emitter.setStartColorVar(startColorVar);

        var endColor = cc.c4f(0.1, 0.1, 0.1, 0.2);
        this._emitter.setEndColor(endColor);

        var endColorVar = cc.c4f(0.1, 0.1, 0.1, 0.2);
        this._emitter.setEndColorVar(endColorVar);

        // size, in pixels
        this._emitter.setStartSize(1.0);
        this._emitter.setStartSizeVar(1.0);
        this._emitter.setEndSize(32.0);
        this._emitter.setEndSizeVar(8.0);

        // Set particle texture
        this._emitter.setTexture(cc.TextureCache.getInstance().addImage(res.fire_png));
        // Set particle shapeType (only on canvas render mode)
        if (this._emitter.setShapeType)
            this._emitter.setShapeType(cc.PARTICLE_BALL_SHAPE);

        // Blend additive
        this._emitter.setBlendAdditive(false);

        this.setEmitterPosition();
        this.scheduleUpdate();
    }
});

VaryingSizeTest.create = function() {
    var layer = new VaryingSizeTest();
    return layer;
}